function getText(t){return t?"string"==typeof t?t.replace(/\n/gm,"").trim():t.content?t.content.replace(/[\s]{3,}/gm,"\n").trim():t[0].content.replace(/[\s]{3,}/gm,"\n").trim():""}module.exports=function(t,e,a){Ti.Yahoo.yql('select * from html where url="'+t+'" and xpath="//table"',function(t){if(t.success&&t.data&&t.data.table&&t.data.table.length>2){var r=t.data.table,i=[];r.forEach(function(t){if("form"!=t["class"]){var e={};t.tbody.tr&&t.tbody.tr instanceof Array&&t.tbody.tr.forEach(function(t){if(t.th&&(e.title=t.th.h1,e.subtitle=t.th.h2),t.td&&"navi"!=t.td["class"])for(var a=0;a<t.td.length;a++)if("right"==t.td[a]["class"])switch(t.td[a].content){case"Autor(en):":e.autor=getText(t.td[a+1].content);break;case"Inhaltsangabe:":e.inhalt=getText(t.td[a+1]);break;case"Produktion:":e.produktion=t.td[a+1];var r=/^[A-Za-z]+/.exec(e.produktion);console.log(r),r&&r instanceof Array&&(e.logo="/images/"+r[r.length-1].toLowerCase()+".png");break;case"Komponist(en):":e.komponisten=getText(t.td[a+1].content);break;case"Regisseur(e):":e.regisseure=getText(t.td[a+1].content);break;case"Ãœbersetzer:":e.uebersetzer=getText(t.td[a+1].content);break;case"Mitwirkende:":e.mitwirkende=require("controls/staff")(t.td[a+1])}}),e.title&&i.push(e)}}),e(i)}else a()})};