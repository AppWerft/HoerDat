function getText(t){return"string"==typeof t?t.replace(/\n/gm,"").trim():t.content?t.content.replace(/[\s]{3,}/gm,"\n").trim():t[0].content.replace(/[\s]{3,}/gm,"\n").trim()}module.exports=function(t,e,a){Ti.Yahoo.yql('select * from html where url="'+t+'" and xpath="//table"',function(t){if(t.success&&t.data&&t.data.table&&t.data.table.length>2){var r=t.data.table,i=[];r.forEach(function(t){if("form"!=t.class){var e={};t.tr.forEach(function(t){if(t.th&&(e.title=t.th.h1,e.subtitle=t.th.h2),t.td&&"navi"!=t.td.class)for(var a=0;a<t.td.length;a++)if("right"==t.td[a].class)switch(t.td[a].p){case"Autor(en):":e.autor=getText(t.td[a+1].p);break;case"Inhaltsangabe:":e.inhalt=getText(t.td[a+1].p);break;case"Produktion:":if(e.produktion=getText(t.td[a+1].p),e.produktion){var r=/^(.*?)\s/.exec(e.produktion.replace("/"," "));r&&(e.logo="/images/"+r[1].toLowerCase()+".png")}break;case"Komponist(en):":e.komponisten=getText(t.td[a+1].p);break;case"Regisseur(e):":e.regisseure=getText(t.td[a+1].p);break;case"Ãœbersetzer:":e.uebersetzer=getText(t.td[a+1].p)}}),e.title&&i.push(e)}}),e(i)}else a()})};